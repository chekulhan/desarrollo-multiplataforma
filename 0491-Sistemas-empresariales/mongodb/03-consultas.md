

https://mongodb-devhub-cms.s3.us-west-1.amazonaws.com/Mongo_DB_Shell_Cheat_Sheet_1a0e3aa962.pdf

ObjectIds are 12-byte unique identifiers automatically generated by MongoDB unless you provide your own. 


Press Ctrl + Alt + R (or Cmd + Option + R on Mac), OR

Click the "Play ‚ñ∂Ô∏è" button that appears above the query, OR

Right-click in the editor and choose "Run All MongoDB Commands".


```js
use("sample_mflix")
db.help // admin commandos

// getName,getCollectionNames, getCollection, getUsers, hello (checks connection), stats
db.getName()


/*
Busquedas de repaso

Encontrar:
- documento con nombre de "Gregor Clegane"

Embedded Movies
- documento con genre (g√©nero) en "Comedy".
- documento con el plot (argumento) que contenga "Andre Moreau".
- documento con votes (votos) mayores que 1000. Mostrar solo los directores de la pel√≠culas
- document con 'released' (fecha de estreno) entre 1914 y 1915. Mostrar solo el t√≠tulo y la fecha de estreno.
*/
```



# REGEX
## üìå Resumen de patrones RegExp en MongoDB

| Patr√≥n        | Significado                                 | Ejemplo (campo: `artist` o `title`)             |
|---------------|---------------------------------------------|-------------------------------------------------|
| `^abc`        | Empieza con "abc"                           | `"^Blue"` ‚Üí `Blue √ñyster Cult`                  |
| `abc$`        | Termina con "abc"                           | `"Cult$"` ‚Üí `Blue √ñyster Cult`                  |
| `.*`          | Cualquier car√°cter, cualquier cantidad      | `"Blue.*Cult"` ‚Üí `Blue √ñyster Cult`, `Blue Cult Revival` |
| `\d`          | Un d√≠gito del 0 al 9                        | `"\d"` ‚Üí `99 Problems`                          |
| `\w`          | Un car√°cter alfanum√©rico o guion bajo       | `"\w+\s\w+"` ‚Üí `Take Me`                        |
| `[aeiou]`     | Cualquier vocal                             | `"[aeiou]"` ‚Üí coincide con cualquier vocal      |
| `[^aeiou]`    | Cualquier car√°cter que **no** sea vocal     | `"[^aeiou]"` ‚Üí coincide con consonantes, etc.   |
| `a|b`         | Coincide con "a" o con "b"                  | `"Godzilla|Reaper"` ‚Üí cualquiera de los dos     |

## üîç Ejemplo de uso en MongoDB

```js
// Encuentra artistas que empiecen por "Blue"
db.songs.find({
  artist: { $regex: /^Blue/, $options: 'i' }
});
```

```js
use("scott");

db.songs.insertMany( [
   { _id: 0, "artist" : "Blue √ñyster Cult", "title": "The Reaper" },
   { _id: 1, "artist": "Blue √ñyster Cult", "title": "Godzilla" },
   { _id: 2, "artist" : "Blue Oyster Cult", "title": "Take Me Away" }
] )


db.songs.find({
  artist: { $regex: /blue.*oyster.*cult/i }
});


db.songs.find({
  title: { $regex: /god/i }
});


db.songs.find({
  artist: { $regex: /^Blue/, $options: 'i' }
});


db.songs.find({
  title: { $regex: /Away$/, $options: 'i' }
});


db.songs.find({
  artist: { $regex: /[√º√∂]/i }
});


// con exactamente 2 palabras w=word, s=space
db.songs.find({
  title: { $regex: /^\w+\s\w+$/ }
});

// si contiene un n√∫mero d=d√≠gito
db.songs.find({
  title: { $regex: /\d/ }
});
```


## Actividades de regex

```js
db.peliculas.insertMany([
  { titulo: "Volver al Futuro", director: "Robert Zemeckis", a√±o: 1985 },
  { titulo: "The Matrix", director: "Lana Wachowski", a√±o: 1999 },
  { titulo: "Matrix Reloaded", director: "Lana Wachowski", a√±o: 2003 },
  { titulo: "Amores Perros", director: "Alejandro Gonz√°lez I√±√°rritu", a√±o: 2000 },
  { titulo: "Misi√≥n Imposible", director: "Brian De Palma", a√±o: 1996 },
  { titulo: "Misi√≥n Imposible 2", director: "John Woo", a√±o: 2000 },
  { titulo: "Mi Villano Favorito", director: "Pierre Coffin", a√±o: 2010 },
  { titulo: "Mi Pobre Angelito", director: "Chris Columbus", a√±o: 1990 },
  { titulo: "Interestelar", director: "Christopher Nolan", a√±o: 2014 },
  { titulo: "Interstellar", director: "Christopher Nolan", a√±o: 2014 }
]);
```
Buscar:
1. Todas las peliculas de Mision Imposible.
2. Encuentra todas las pel√≠culas cuyo t√≠tulo comienza con "Mi".
3. Encuentra todas las pel√≠culas cuyo t√≠tulo termina con un n√∫mero.
4. Encuentra pel√≠culas del director "Christopher Nolan", sin importar c√≥mo est√© escrito (por ejemplo: con o sin min√∫sculas).
5. Encuentra las pel√≠culas cuyo t√≠tulo contiene la palabra "Inter" (como parte del nombre).
6. Encontrar las peliculas de Mision Imposible o (OR) Matrix.



//db.comments.find({"name": "Gregor Clegane"})

//db.comments.find().limit(5)

//db.comments.findOne({name:"Gregor Clegane"}, {name: 1, text: 1, _id:0})

//db.comments.find({"name": "Gregor Clegane"})
// db.comments.findOne({movie_id: ObjectId("573a1390f29313caabcd5b9a")})

/* db.comments.findOne(
    {date: 
        {$gt: ISODate('2015-02-08T00:00:00Z')} 
    })

{"released": {
    $gte: ISODate("1914-01-01T00:00:00.000Z"),
    $lt: ISODate("1915-01-01T00:00:00.000Z")
}
}

 db.comments.find({
    $or: [
        {name: "John Bishop"},
        {email: "gemma_whelan@gameofthron.es"}
    ]
}).sort({date: -1})  // descending */


// // TO DO
// db.comments.aggregate({
//     $group: []
// })



db.peliculas.find({
  director: { $regex: /^christopher nolan$/i }
});

db.peliculas.find({
  titulo: { $regex: /\d$/ }
});

db.peliculas.find({
  titulo: { $regex: /^Mi/, $options: 'i' }
});


db.peliculas.find({
  $or: [
    { titulo: { $regex: /misi[o√≥]n imposible/i } },
    { titulo: { $regex: /interest(i|e)lar/i } }
  ]
});